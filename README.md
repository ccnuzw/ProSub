# ProSub: ä½ çš„ç§äººä»£ç†è®¢é˜…ä¸èŠ‚ç‚¹ç®¡ç†ä¸­å¿ƒ

ProSub æ˜¯ä¸€ä¸ªåŸºäº Cloudflare Pages å’Œ KV å­˜å‚¨çš„è½»é‡çº§ã€é«˜æ€§èƒ½ä»£ç†è®¢é˜…ç®¡ç†é¡¹ç›®ã€‚å®ƒå…è®¸ä½ è½»æ¾èšåˆã€ç®¡ç†å’Œåˆ†äº«æ¥è‡ªä¸åŒæ¥æºçš„ä»£ç†èŠ‚ç‚¹ï¼Œç”Ÿæˆå®Œå…¨è‡ªå®šä¹‰çš„è®¢é˜…é“¾æ¥ã€‚

![ProSub ä»ªè¡¨ç›˜æˆªå›¾](https://i.imgur.com/your-dashboard-screenshot.png) ## âœ¨ æ ¸å¿ƒåŠŸèƒ½

æˆ‘ä»¬ä»é›¶å¼€å§‹ï¼Œå…±åŒæ„å»ºäº†ä¸€å¥—åŠŸèƒ½å¼ºå¤§ä¸”ç”¨æˆ·ä½“éªŒä¼˜ç§€çš„æ ¸å¿ƒåŠŸèƒ½ï¼š

* **ä»ªè¡¨ç›˜**: ç›´è§‚å±•ç¤ºèŠ‚ç‚¹ã€è®¢é˜…ã€é…ç½®æ–‡ä»¶å’Œæµé‡è¯·æ±‚çš„å…³é”®ç»Ÿè®¡æ•°æ®ã€‚
* **å¼ºå¤§çš„èŠ‚ç‚¹ç®¡ç†**:
    * æ”¯æŒ Vmess, VLESS, SS, Trojan, SSR ç­‰å¤šç§ä¸»æµåè®®èŠ‚ç‚¹çš„å¢åˆ æ”¹æŸ¥ã€‚
    * **æ™ºèƒ½å¥åº·æ£€æŸ¥**: ä¸€é”®æ£€æµ‹æ‰€æœ‰èŠ‚ç‚¹çš„åœ¨çº¿çŠ¶æ€å’ŒçœŸå®ç½‘ç»œå»¶è¿Ÿ(ms)ã€‚
    * **æ‰¹é‡æ“ä½œ**: æ”¯æŒä»å‰ªè´´æ¿æ‰¹é‡å¯¼å…¥èŠ‚ç‚¹ï¼Œå¹¶èƒ½è‡ªåŠ¨è¿›è¡Œ**ç²¾ç¡®å»é‡**ï¼ˆæœåŠ¡å™¨+ç«¯å£+å¯†ç ï¼‰ã€‚æ”¯æŒå¤šé€‰æ‰¹é‡åˆ é™¤ã€‚
    * **æ™ºèƒ½æ’åºä¸è¿‡æ»¤**: èŠ‚ç‚¹åˆ—è¡¨å¯æŒ‰çŠ¶æ€å’Œå»¶è¿Ÿè‡ªåŠ¨æ’åºï¼Œå¹¶æ”¯æŒæŒ‰åç§°ã€æœåŠ¡å™¨ã€ç±»å‹è¿›è¡Œå®æ—¶æœç´¢ã€‚
* **å®Œå–„çš„è®¢é˜…ç®¡ç†**:
    * æ”¯æŒèšåˆå¤šä¸ªå¤–éƒ¨è®¢é˜…é“¾æ¥ã€‚
    * **ä¸€é”®æ›´æ–°**: å¯å•ç‹¬æˆ–æ‰¹é‡æ›´æ–°æ‰€æœ‰è®¢é˜…ï¼Œè·å–æœ€æ–°çš„èŠ‚ç‚¹åˆ—è¡¨ã€‚
    * **çŠ¶æ€æ€»è§ˆ**: æ¸…æ™°å±•ç¤ºæ¯ä¸ªè®¢é˜…çš„èŠ‚ç‚¹æ•°é‡ã€æœ€åæ›´æ–°æ—¶é—´åŠæ›´æ–°çŠ¶æ€ã€‚
    * **èŠ‚ç‚¹é¢„è§ˆ**: æ— éœ€ä¸‹è½½ï¼Œç›´æ¥åœ¨å¼¹çª—å†…ä»¥è¡¨æ ¼å½¢å¼é¢„è§ˆè®¢é˜…ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹ä¿¡æ¯ã€‚
    * **æ‰¹é‡å¯¼å…¥**: æ”¯æŒä»å‰ªè´´æ¿æ‰¹é‡å¯¼å…¥å¤šä¸ªè®¢é˜…é“¾æ¥ã€‚
* **çµæ´»çš„é…ç½®æ–‡ä»¶**:
    * é€šè¿‡ç›´è§‚çš„**ç©¿æ¢­æ¡†**ç•Œé¢ï¼Œè‡ªç”±ç»„åˆæ‰‹åŠ¨æ·»åŠ çš„èŠ‚ç‚¹å’Œå¤–éƒ¨è®¢é˜…ã€‚
    * ç©¿æ¢­æ¡†å†…çš„èŠ‚ç‚¹åˆ—è¡¨åŒæ ·æ”¯æŒ**çŠ¶æ€æ˜¾ç¤ºå’Œæ™ºèƒ½æ’åº**ï¼Œæ–¹ä¾¿ä½ æ°¸è¿œä¼˜å…ˆé€‰æ‹©æœ€ä¼˜è´¨çš„èŠ‚ç‚¹ã€‚
    * ä¸ºæ¯ä¸ªé…ç½®æ–‡ä»¶ç”Ÿæˆç‹¬ä¸€æ— äºŒçš„ã€å…¼å®¹ä¸»æµå®¢æˆ·ç«¯çš„è®¢é˜…é“¾æ¥ã€‚
* **å¤šç”¨æˆ·æ”¯æŒ**:
    * å†…ç½®ç®€å•çš„ç”¨æˆ·ç®¡ç†ç³»ç»Ÿï¼Œæ”¯æŒå¤šç”¨æˆ·ä½¿ç”¨ã€‚
    * é»˜è®¤ `admin` ç®¡ç†å‘˜è´¦æˆ·ï¼Œé¦–æ¬¡ç™»å½•å¼ºåˆ¶ä¿®æ”¹å¯†ç ï¼Œç¡®ä¿å®‰å…¨ã€‚

## ğŸš€ æŠ€æœ¯æ ˆ

* **å‰ç«¯**: Next.js (App Router), React, Ant Design, TypeScript
* **åç«¯/éƒ¨ç½²**: Cloudflare Pages & Workers (Edge Runtime)
* **æ•°æ®åº“**: Cloudflare KV

## éƒ¨ç½²æŒ‡å—

æœ¬é¡¹ç›®ä¸“ä¸º Cloudflare Pages è®¾è®¡ï¼Œè¯·ä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤è¿›è¡Œéƒ¨ç½²ã€‚

### å‰ææ¡ä»¶
* ä¸€ä¸ª GitHub è´¦å·
* ä¸€ä¸ª Cloudflare è´¦å·
* æœ¬åœ°å·²å®‰è£… Node.js å’Œ Git

### ç¬¬ 1 æ­¥ï¼šåˆ›å»º KV å‘½åç©ºé—´
1.  ç™»å½• Cloudflare ä»ªè¡¨ç›˜ï¼Œè¿›å…¥ **Workers & Pages** -> **KV**ã€‚
2.  ç‚¹å‡» **åˆ›å»ºå‘½åç©ºé—´**ï¼Œè¾“å…¥ä¸€ä¸ªä½ å–œæ¬¢çš„åå­—ï¼ˆä¾‹å¦‚ `PROSUB_DB`ï¼‰ã€‚

### ç¬¬ 2 æ­¥ï¼šéƒ¨ç½²åˆ° Cloudflare Pages
1.  åœ¨ Cloudflare ä»ªè¡¨ç›˜ï¼Œè¿›å…¥ **Workers & Pages**ï¼Œé€‰æ‹© **åˆ›å»ºåº”ç”¨ç¨‹åº** -> **Pages** -> **è¿æ¥åˆ° Git**ã€‚
2.  é€‰æ‹©ä½ çš„ `ProSub` GitHub ä»“åº“ã€‚
3.  åœ¨ **æ„å»ºè®¾ç½®** é¡µé¢ï¼Œè¿›è¡Œå¦‚ä¸‹é…ç½®ï¼š
    * **æ¡†æ¶é¢„è®¾**: é€‰æ‹© `Next.js`ã€‚Cloudflare ä¼šè‡ªåŠ¨å¡«å……å¤§éƒ¨åˆ†è®¾ç½®ã€‚
    * **æ„å»ºå‘½ä»¤**: `npx @cloudflare/next-on-pages@1`
    * **æ„å»ºè¾“å‡ºç›®å½•**: `/.vercel/output/static`
4.  ç‚¹å‡» **ä¿å­˜å¹¶éƒ¨ç½²**ã€‚

### ç¬¬ 3 æ­¥ï¼šé…ç½®ç¯å¢ƒå˜é‡å’Œ KV ç»‘å®š (æœ€å…³é”®çš„ä¸€æ­¥)
é¦–æ¬¡éƒ¨ç½²å¯èƒ½ä¼šå¤±è´¥æˆ–æŠ¥é”™ï¼Œæ²¡å…³ç³»ï¼Œå› ä¸ºæˆ‘ä»¬è¿˜éœ€è¦å®Œæˆæœ€åçš„é…ç½®ã€‚

1.  è¿›å…¥ä½ åˆšåˆšåˆ›å»ºçš„ `ProSub` Pages é¡¹ç›®ï¼Œç‚¹å‡» **Settings** -> **Functions**ã€‚
2.  å‘ä¸‹æ»šåŠ¨åˆ° **KV namespace bindings** (KV å‘½åç©ºé—´ç»‘å®š)ï¼Œç‚¹å‡» **Edit bindings**ã€‚
    * **å˜é‡åç§°**: `KV`
    * **KV å‘½åç©ºé—´**: é€‰æ‹©ä½ åœ¨ç¬¬ 1 æ­¥åˆ›å»ºçš„é‚£ä¸ªå‘½åç©ºé—´ (ä¾‹å¦‚ `PROSUB_DB`)ã€‚
    * ä¿å­˜ã€‚
3.  è¿”å› **Settings** -> **Functions**ï¼Œå‘ä¸‹æ»šåŠ¨åˆ° **Compatibility Flags** (å…¼å®¹æ€§æ ‡å¿—)ã€‚
4.  åœ¨ **Production** ä¸‹ï¼Œç‚¹å‡» **Configure Flags**ï¼Œç„¶åæ·»åŠ  `nodejs_compat` è¿™ä¸ªæ ‡å¿—ã€‚
5.  ä¿å­˜ã€‚

### ç¬¬ 4 æ­¥ï¼šé‡æ–°éƒ¨ç½²
å›åˆ°é¡¹ç›®çš„ **Deployments** é¡µé¢ï¼Œç‚¹å‡» **Retry deployment** é‡æ–°è§¦å‘ä¸€æ¬¡éƒ¨ç½²ã€‚è¿™æ¬¡ï¼Œåº”ç”¨å°†ä¼šä½¿ç”¨æ‰€æœ‰æ­£ç¡®çš„é…ç½®ï¼Œå¹¶æˆåŠŸä¸Šçº¿ã€‚

### ç¬¬ 5 æ­¥ï¼šé¦–æ¬¡ç™»å½•
éƒ¨ç½²æˆåŠŸåï¼Œè®¿é—®ä½ çš„ `*.pages.dev` ç½‘å€ã€‚
* é»˜è®¤ç”¨æˆ·å: `admin`
* é»˜è®¤å¯†ç : `admin`
é¦–æ¬¡ç™»å½•åï¼Œç³»ç»Ÿä¼šå¼ºåˆ¶ä½ ä¿®æ”¹å¯†ç ã€‚

## æœ¬åœ°å¼€å‘
ç”±äºé¡¹ç›®ä¾èµ– Cloudflare KV å’Œ Edge Runtimeï¼Œä¸èƒ½ç›´æ¥ä½¿ç”¨ `npm run dev`ã€‚è¯·ä½¿ç”¨ Cloudflare çš„å®˜æ–¹å·¥å…· `Wrangler` è¿›è¡Œæœ¬åœ°å¼€å‘ã€‚
1.  å®‰è£… Wrangler: `npm install -g wrangler`
2.  ç™»å½•: `wrangler login`
3.  åœ¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œ: `wrangler pages dev .next --kv=<ä½ çš„KVå‘½åç©ºé—´åç§°>`

---
*è¿™ä¸ªé¡¹ç›®åœ¨ Gemini çš„ååŠ©ä¸‹å®Œæˆäº†ä» Bug ä¿®å¤åˆ°åŠŸèƒ½å®Œå–„çš„å…¨è¿‡ç¨‹ã€‚*